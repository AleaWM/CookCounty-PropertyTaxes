---
title: "Polycentricity & Representation"
subtitle: "Cook County Descriptive Statistics<br>(2012-2022)"
author: "Michael Van Hulle"
date: "July 11, 2024"
format: 
  html:
    embed-resources: true
    theme: lumen
    code-fold: true
    code-line-numbers: true
    code-overflow: wrap
    toc: true
    toc-location: left
    df-print: paged
knitr: 
  opts_chunk:
    warning: true
    message: false
---

```{r setup}
#| Output: FALSE

library(tidyverse)
library(plm)
library(glue)
library(DT)
library(flextable)
library(kableExtra)

set_flextable_defaults(theme_fun = theme_vanilla, 
                       padding = 2,
                       #line_spacing = 1,
                       big.mark = ","
                       )

options(DT.options = list())

FitFlextableToPage <- function(ft, pgwidth = 6){
  ft_out <- ft %>% autofit()
  ft_out <- width(ft_out, width = dim(ft_out)$widths*pgwidth /(flextable_dim(ft_out)$widths))
  return(ft_out)
}

```

Import data

```{r data_import}
#| output: false

comm_ind_pins_ever <- read_csv("./Output/comm_ind_PINs_2006-2022.csv") |>
  filter(dplyr::between(year, 2011, 2022))

```

# Pre-balancing

Initially, we have 1,282,930 PIN-year obs. 

## Cleanup

```{r data_clean}

comm_ind_pins_2011 <- comm_ind_pins_ever  %>% 
  #filter(year >= 2011) %>%
  group_by(pin) |>
  mutate(incentive_years = sum(incent_prop == "Incentive"),
         landuse_change = 
           ifelse(
             sum(land_use == "Commercial") == 12, "Always Commercial",
             ifelse(sum(land_use == "Industrial") == 12, "Always Industrial",
                    ifelse(sum(land_use == "Exempt") == 12, "Drop Me",
                           "Changes Land Use" ))),
         years_existed = n()  
         )  %>%
  ungroup() %>%
  #filter(years_existed == 12) %>%
  group_by(pin) %>%
  mutate(
    base_year_fmv_2011 = fmv[year == 2011],
    fmv_growth_2011 = fmv/base_year_fmv_2011,
    incent_change = case_when(
      incentive_years == 12 ~ "Always Incentive",
      incentive_years == 0 ~ "Never Incentive",
      TRUE ~ "Changes Sometime")
  ) |> 
  filter(landuse_change!= "Drop Me")

```

## Descriptive Statistics

```{r unbalanced_descrips}



```

# Balanced panel

## Balancing panel

```{r balance_panel}


```


### Tests of missingness

```{r t_o_m}


```


## Descriptive Statistics

```{r balanced_stats}



```